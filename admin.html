<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Panel admina</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="header">
    <div class="logo" onclick="location.href='index.html'">← Wróć</div>
  </div>

  <div id="loginPanel" class="admin-panel">
    <h2>Zaloguj się</h2>
    <input type="text" id="username" placeholder="Login">
    <input type="password" id="password" placeholder="Hasło">
    <button onclick="login()">Zaloguj</button>
  </div>

  <div id="adminPanel" class="admin-panel hidden">
    <h2>Dodaj produkt</h2>
    <input id="link" placeholder="Link do aukcji (AliExpress)">
    <input id="image" placeholder="(opcjonalnie) Link do zdjęcia">
    <input id="name" placeholder="Nazwa">
    <input id="desc" placeholder="Opis">
    <input id="price" placeholder="Cena (PLN)">
    <select id="batch">
      <option>best</option>
      <option>budżet</option>
    </select>
    <button onclick="addProduct()">Dodaj</button>

    <h3 style="margin-top:40px;">Twoje produkty:</h3>
    <div id="productList"></div>
  </div>

  <script>
    const loginPanel = document.getElementById("loginPanel");
    const adminPanel = document.getElementById("adminPanel");
    const productList = document.getElementById("productList");

    function login() {
      const u = document.getElementById("username").value;
      const p = document.getElementById("password").value;
      if (u === "admin" && p === "1234") {
        loginPanel.classList.add("hidden");
        adminPanel.classList.remove("hidden");
        renderAdminProducts();
      } else {
        alert("Błędny login lub hasło");
      }
    }

    function extractImage(link) {
      const custom = document.getElementById("image").value;
      if (custom) return custom;
      // Przykładowy link do obrazka z Ali
      const match = link.match(/https?:\/\/[^"]+\.jpg/);
      return match ? match[0] : "https://via.placeholder.com/150";
    }

    function addProduct() {
      const products = JSON.parse(localStorage.getItem("products") || "[]");
      const link = document.getElementById("link").value;
      const image = extractImage(link);
      const prod = {
        link,
        image,
        name: document.getElementById("name").value,
        desc: document.getElementById("desc").value,
        price: document.getElementById("price").value,
        batch: document.getElementById("batch").value
      };
      products.push(prod);
      localStorage.setItem("products", JSON.stringify(products));
      alert("Dodano!");
      clearInputs();
      renderAdminProducts();
    }

    function clearInputs() {
      document.getElementById("link").value = "";
      document.getElementById("image").value = "";
      document.getElementById("name").value = "";
      document.getElementById("desc").value = "";
      document.getElementById("price").value = "";
    }

    function renderAdminProducts() {
      const products = JSON.parse(localStorage.getItem("products") || "[]");
      if (products.length === 0) {
        productList.innerHTML = "<p>Brak produktów</p>";
        return;
      }

      productList.innerHTML = products.map((p, i) => `
        <div class="product">
          <img src="${p.image}" />
          <h4>${p.name}</h4>
          <p>${p.price} PLN</p>
          <button onclick="removeProduct(${i})">Usuń</button>
        </div>
      `).join('');
    }

    function removeProduct(index) {
      const products = JSON.parse(localStorage.getItem("products") || "[]");
      products.splice(index, 1);
      localStorage.setItem("products", JSON.stringify(products));
      renderAdminProducts();
    }
  </script>
</body>
</html>
