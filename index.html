<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YUNG R3PS</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="header">
    <div class="logo" onclick="location.href='admin.html'">
      <img src="logo.png" alt="Logo">
    </div>
    <input type="text" id="searchInput" placeholder="Szukaj produktów...">
  </div>

  <div class="filter-btn" onclick="toggleFilters()">
    <div class="bar"></div>
    <div class="bar"></div>
    <div class="bar"></div>
  </div>

  <div class="filter-panel" id="filters">
    <h3>Filtry</h3>
    
    <div class="filter-section">
      <div class="filter-header" onclick="toggleFilterSection('batch')">
        <span>Batch</span>
        <span class="arrow">▼</span>
      </div>
      <div class="filter-options" id="batch-options">
        <button onclick="setFilter('batch', 'best')">Best</button>
        <button onclick="setFilter('batch', 'budżet')">Budżet</button>
      </div>
    </div>

    <div class="filter-section">
      <div class="filter-header" onclick="toggleFilterSection('category')">
        <span>Kategoria</span>
        <span class="arrow">▼</span>
      </div>
      <div class="filter-options" id="category-options">
        <button onclick="setFilter('category', 'shoes')">Buty</button>
        <button onclick="setFilter('category', 'socks')">Skarpetki</button>
        <button onclick="setFilter('category', 'pants')">Spodnie</button>
        <button onclick="setFilter('category', 'jackets')">Kurtki</button>
        <button onclick="setFilter('category', 't-shirts')">Koszulki</button>
        <button onclick="setFilter('category', 'hoodies')">Bluzy</button>
        <button onclick="setFilter('category', 'shorts')">Szorty</button>
        <button onclick="setFilter('category', 'accessories')">Akcesoria</button>
      </div>
    </div>

    <button class="apply-btn" onclick="applyFilters()">Zatwierdź</button>
  </div>

  <div class="product-list" id="productList">
    <!-- Produkty będą renderowane tutaj -->
  </div>

  <script>
    let allProducts = JSON.parse(localStorage.getItem("products") || "[]");
    let activeFilters = {};

    function toggleFilters() {
      document.getElementById("filters").classList.toggle("visible");
    }

    function toggleFilterSection(section) {
      const options = document.getElementById(`${section}-options`);
      const arrow = document.querySelector(`#${section}-options`).previousElementSibling.querySelector('.arrow');
      options.classList.toggle("visible");
      arrow.textContent = options.classList.contains("visible") ? "▲" : "▼";
    }

    function setFilter(type, value) {
      activeFilters[type] = value;
    }

    function applyFilters() {
      let filtered = [...allProducts];
      
      // Filtrowanie po batchu
      if (activeFilters.batch) {
        filtered = filtered.filter(p => p.batch === activeFilters.batch);
      }
      
      // Filtrowanie po kategorii
      if (activeFilters.category) {
        filtered = filtered.filter(p => p.category === activeFilters.category);
      }
      
      // Filtrowanie po wyszukiwarce
      const query = document.getElementById("searchInput").value.toLowerCase();
      if (query) {
        filtered = filtered.filter(p => 
          p.name.toLowerCase().includes(query) || 
          p.desc.toLowerCase().includes(query)
        );
      }
      
      renderProducts(filtered);
      toggleFilters();
    }

    function renderProducts(products) {
      const container = document.getElementById("productList");
      container.innerHTML = products.map(product => `
        <div class="product">
          <img src="${product.image || 'placeholder.jpg'}" alt="${product.name}">
          <h3>${product.name}</h3>
          <p>${product.desc}</p>
          <span class="price">${product.price} PLN</span>
          <span class="badge ${product.batch}">${product.batch}</span>
          <a href="${product.link}" target="_blank" class="link-btn">LINK</a>
        </div>
      `).join('');
    }

    // Inicjalizacja
    document.getElementById("searchInput").addEventListener("input", applyFilters);
    renderProducts(allProducts);
  </script>
</body>
</html>
